---

import { profileConfig } from "../config";
import { url } from "../utils/url-utils";

const currentYear = new Date().getFullYear();
---

<!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">-->
<div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div>
<!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">-->
<div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6">
    <div class="transition text-50 text-sm text-center">
        &copy; <span id="copyright-year">{currentYear}</span> {profileConfig.name}<!--. All Rights Reserved.
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('rss.xml')}>RSS</a> 
        <span class="split">|</span>
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('sitemap-index.xml')}>网站地图</a>
        -->
        <a target="_blank" href={url('sitemap-index.xml')}>网站地图</a>
        <span id="cdn-platform" class="ml-2"></span>
        <br>
        <!--
        <a>CDN</a> <span id="cdn-platform"></span>
        Powered by
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a>
        -->
        <a href="https://beian.miit.gov.cn/" target="beian_blank">豫ICP备2026006191号-1</a>
        <!--
        <span class="split">|</span>
        <span><img src="/frame/images/ga.png" width="16px" class="mr-1"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51060302510971" target="ga_blank" rel="nofollow noreferrer">川公网安备51060302510971号</a></span>
        -->
    </div>
</div>

<script>
// 简单的CDN平台检测函数
function detectCdnPlatform() {
    try {
        // 获取当前URL的主机名
        const hostname = window.location.hostname;
        
        // 基于主机名或其他特征检测平台
        let platform = null;
        
        // 检查是否为本地开发环境
        if (hostname === 'localhost' || hostname === '127.0.0.1') {
            // 本地环境可以显示所有平台图标或不显示
            return;
        }
        
        // 尝试使用navigator.userAgent检测（备用方案）
        const userAgent = navigator.userAgent.toLowerCase();
        
        // 显示对应图标
        const container = document.getElementById('cdn-platform');
        if (container) {
            // 清除现有内容
            container.innerHTML = '';
            
            // 创建图标元素
            const createIcon = (platformName, svgPath) => {
                const svg = document.createElement('img');
                svg.className = 'cdn-icon inline-block align-middle';
                svg.style.height = '1em';
                svg.style.width = 'auto';
                svg.style.verticalAlign = 'middle';
                svg.style.display = 'inline-block';
                svg.style.maxWidth = '100%';
                svg.style.marginLeft = '4px';
                svg.src = svgPath;
                svg.alt = `${platformName} CDN`;
                svg.loading = 'eager';
                svg.onerror = function() {
                    this.style.display = 'none';
                };
                return svg;
            };
            
            // 直接显示所有平台图标作为备用方案
            // 这样可以确保在所有设备上都能看到图标
            const icons = [
                createIcon('EdgeOne Pages', '/assets/svg/edgeone-pages.svg'),
                createIcon('Cloudflare', '/assets/svg/Cloudflare.svg'),
                createIcon('Vercel', '/assets/svg/Vercel.svg')
            ];
            
            // 添加图标到容器
            icons.forEach(icon => {
                container.appendChild(icon);
            });
        }
    } catch (error) {
        console.error('CDN platform detection failed:', error);
    }
}

// 页面加载后检测
if (typeof window !== 'undefined') {
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', detectCdnPlatform);
    } else {
        detectCdnPlatform();
    }
    
    // 窗口加载完成后再次检测
    window.addEventListener('load', detectCdnPlatform);
}
</script>